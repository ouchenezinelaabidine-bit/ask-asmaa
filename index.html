<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>الأستاذة أسماء عبد الله مهدي | منصة الرياضيات</title>

<!-- MathJax -->
<script>
window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };
</script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<style>
:root{
  --bg:#061225;
  --panel:#0b1f3a;
  --panel2:#0f2a52;
  --line:rgba(255,255,255,.08);
  --text:#eaf2ff;
  --muted:#9fb3d9;
  --accent:#4da3ff;
  --whatsapp:#25d366;
  --facebook:#1877f2;
  --bot:#132c52;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,Segoe UI,Arial;
  background:linear-gradient(180deg,#061225,#071b33);
  color:var(--text);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.app{
  width:100%;
  max-width:1200px;
  height:100vh;
  max-height:860px;
  display:grid;
  grid-template-columns: 360px 1fr;
}
@media(max-width:900px){
  .app{
    grid-template-columns:1fr;
    grid-template-rows:auto 1fr;
    height:100vh;
  }
}

/* Sidebar */
.sidebar{
  background:var(--panel);
  border-left:1px solid var(--line);
  padding:18px;
}
.sidebar h1{
  margin:0;
  font-size:20px;
  font-weight:800;
}
.sidebar p{
  margin:8px 0 16px;
  font-size:13px;
  color:var(--muted);
  line-height:1.7;
}
.card{
  background:var(--panel2);
  border:1px solid var(--line);
  border-radius:16px;
  padding:14px;
  margin-bottom:14px;
}
.card h3{
  margin:0 0 8px;
  font-size:15px;
}
.card p{
  margin:0;
  font-size:13px;
  color:var(--muted);
  line-height:1.7;
}
.lang{
  display:flex;
  gap:8px;
}
.lang button{
  flex:1;
  border-radius:999px;
  border:1px solid var(--line);
  background:transparent;
  color:var(--text);
  padding:8px;
  cursor:pointer;
}
.lang button.active{
  background:var(--accent);
  color:#041225;
}

/* Chat */
.chatWrap{
  background:var(--bg);
  display:flex;
  flex-direction:column;
}
.chatHeader{
  padding:14px 16px;
  border-bottom:1px solid var(--line);
  font-weight:800;
}
.chat{
  flex:1;
  padding:16px;
  overflow:auto;
  display:flex;
  flex-direction:column;
  gap:14px;
}
.msg{
  max-width:80%;
  padding:12px 14px;
  border-radius:18px;
  line-height:1.7;
  white-space:pre-wrap;
  box-shadow:0 6px 20px rgba(0,0,0,.25);
}
.me{
  align-self:flex-start;
  background:linear-gradient(135deg,var(--facebook),#4da3ff);
  color:#041225;
}
.bot{
  align-self:flex-end;
  background:var(--bot);
  border:1px solid var(--line);
}
.meta{
  font-size:12px;
  color:var(--muted);
  margin-top:4px;
}
.typing{
  align-self:flex-end;
  font-size:13px;
  color:var(--muted);
}
.dots span{
  display:inline-block;
  width:6px;height:6px;
  background:var(--accent);
  border-radius:50%;
  margin:0 1px;
  animation:blink 1.4s infinite both;
}
.dots span:nth-child(2){animation-delay:.2s}
.dots span:nth-child(3){animation-delay:.4s}
@keyframes blink{
  0%,80%,100%{opacity:.2}
  40%{opacity:1}
}

/* Composer */
.composer{
  padding:12px;
  border-top:1px solid var(--line);
  display:flex;
  gap:10px;
  align-items:center;
}
textarea{
  flex:1;
  resize:none;
  min-height:46px;
  max-height:120px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#041225;
  color:var(--text);
  padding:12px 16px;
  font-size:15px;
}
.actions{
  display:flex;
  flex-direction:column;
  gap:6px;
}
.btn{
  border:0;
  border-radius:999px;
  padding:10px 14px;
  font-weight:800;
  cursor:pointer;
  color:#fff;
}
.send{ background:var(--whatsapp); }
.clear{ background:#ef4444; }
.upload{ background:var(--facebook); }
.btn:disabled{opacity:.5}
</style>
</head>

<body>
<div class="app">

  <!-- Sidebar -->
  <div class="sidebar">
    <h1>الأستاذة أسماء عبد الله مهدي</h1>
    <p>منصة تعليمية متخصصة في شرح الرياضيات بأسلوب واضح واحترافي.</p>

    <div class="card">
      <h3>طريقة التواصل</h3>
      <p>
        • اكتب التمرين بوضوح<br>
        • استخدم الرموز الرياضية<br>
        • يمكنك رفع صورة تمرين<br>
        • الرد يكون خطوة بخطوة
      </p>
    </div>

    <div class="card">
      <h3>اللغة</h3>
      <div class="lang">
        <button class="active" onclick="setLang('ar')">العربية</button>
        <button onclick="setLang('en')">English</button>
      </div>
    </div>
  </div>

  <!-- Chat -->
  <div class="chatWrap">
    <div class="chatHeader">جلسة الرياضيات</div>
    <div id="chat" class="chat"></div>

    <div class="composer">
      <textarea id="input" placeholder="اكتب سؤالك في الرياضيات..."></textarea>
      <div class="actions">
        <button class="btn send" id="send">إرسال</button>
        <button class="btn upload">➕ تمرين</button>
        <button class="btn clear" id="clear">مسح</button>
      </div>
    </div>
  </div>

</div>

<script>
const WORKER_URL="https://ask-asmaa.ouchene-zinelaabidine.workers.dev";
const chat=document.getElementById("chat");
const input=document.getElementById("input");
const sendBtn=document.getElementById("send");
const clearBtn=document.getElementById("clear");

function add(role,text){
  const m=document.createElement("div");
  m.className="msg "+role;
  m.textContent=text;
  chat.appendChild(m);
  const meta=document.createElement("div");
  meta.className="meta";
  meta.textContent=new Date().toLocaleTimeString();
  chat.appendChild(meta);
  chat.scrollTop=chat.scrollHeight;
  if(window.MathJax) MathJax.typesetPromise([m]).catch(()=>{});
}

let typing;
function showTyping(){
  typing=document.createElement("div");
  typing.className="typing";
  typing.innerHTML='الأستاذة أسماء تُحضّر الإجابة <span class="dots"><span></span><span></span><span></span></span>';
  chat.appendChild(typing);
  chat.scrollTop=chat.scrollHeight;
}
function hideTyping(){ if(typing) typing.remove(); }

async function send(){
  const q=input.value.trim();
  if(!q) return;
  add("me",q);
  input.value="";
  sendBtn.disabled=true;
  showTyping();
  try{
    const r=await fetch(WORKER_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({message:q})
    });
    const raw=await r.text();
    let d; try{d=JSON.parse(raw)}catch{d={answer:raw}};
    hideTyping();
    add("bot",(d.answer||"").trim()||"لا يوجد رد.");
  }catch{
    hideTyping();
    add("bot","تعذر الاتصال.");
  }finally{
    sendBtn.disabled=false;
  }
}
sendBtn.onclick=send;
clearBtn.onclick=()=>{ chat.innerHTML=""; add("bot","ابدأ تمرينًا جديدًا."); };
input.addEventListener("keydown",e=>{
  if(e.key==="Enter"&&!e.shiftKey){ e.preventDefault(); send(); }
});

function setLang(l){
  document.querySelectorAll(".lang button").forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
}

add("bot","مرحبًا بك في منصة الرياضيات، تفضل بطرح سؤالك.");
</script>
</body>
</html>
